<html>

<head>
    <link rel="stylesheet" href="style.css" />
    <script src="accessibility.js"></script>
    <script>
        let socket = new WebSocket("ws://" + location.host + "/ws");
        let alert = new Audio('/alert.mp3');

        socket.onmessage = receiveMessage;

        function receiveMessage(msg) {
            let outputBox = document.getElementById('receivedBox');
            var chatMessage = JSON.parse(msg.data);
            outputBox.innerText += chatMessage.name + ': ' + chatMessage.message + '\n';
            speak(chatMessage.name + ' says ' + chatMessage.message);
            alert.play();
            if (chatMessage.message === "Let's play a game!") {
                playGame();
            }
        }

        function sendMessage(msg) {
            socket.send(JSON.stringify({ message: msg }));
        }

        function onMessageFormSubmit() {
            var messageBox = document.getElementById('messageBox');
            sendMessage(messageBox.value);
            messageBox.value = '';
            return false;
        }

        function playGame() {
            var gameElement = document.getElementById('game');
            gameElement.classList.remove('hidden');
        }
    </script>
</head>

<body>
    <h1>VSSSFSHSS</h1>
    <form onsubmit="return onMessageFormSubmit()">
        <label for="messageBox">Message</label>
        <input type="text" id="messageBox" required="true" />
        <button type="submit">Send</button>
    </form>
    <div id="receivedBox"></div>

    <div id="accessibleAlert" role="alert" class="sr-only"></div>

    <div class="hidden" id="game">
        <svg
                width="1920"
                height="1080"
                viewBox="0 0 1920 1080"
                version="1.1"
                id="svg5"
                inkscape:version="1.1.2 (b8e25be8, 2022-02-05)"
                sodipodi:docname="background.svg"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:svg="http://www.w3.org/2000/svg">
            <sodipodi:namedview
                    id="namedview7"
                    pagecolor="#ffffff"
                    bordercolor="#666666"
                    borderopacity="1.0"
                    inkscape:pageshadow="2"
                    inkscape:pageopacity="0.0"
                    inkscape:pagecheckerboard="0"
                    inkscape:document-units="px"
                    showgrid="false"
                    inkscape:lockguides="true"
                    inkscape:zoom="0.5787037"
                    inkscape:cx="959.904"
                    inkscape:cy="540"
                    inkscape:window-width="1920"
                    inkscape:window-height="1027"
                    inkscape:window-x="0"
                    inkscape:window-y="25"
                    inkscape:window-maximized="1"
                    inkscape:current-layer="layer1" />
            <defs
                    id="defs2" />
            <g
                    inkscape:label="Layer 1"
                    inkscape:groupmode="layer"
                    id="layer1">
                <rect
                        style="fill:#0000ff;fill-rule:evenodd"
                        id="rect31"
                        width="1157.76"
                        height="416.448"
                        x="267.84"
                        y="86.400009" />
            </g>
        </svg>

    </div>
</body>

</html>